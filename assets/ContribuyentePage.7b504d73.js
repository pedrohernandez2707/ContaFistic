import{_ as k,d as N,g as d,o as S,c as q,e as t,w as i,Q as g,b7 as B,a as u,P as $,i as _,aA as A,f as s,j as f,b8 as T,l as p}from"./index.de91045c.js";import{h as U}from"./QSelect.2ed87d02.js";import{Q as I}from"./QForm.a37c3e13.js";import{Q as L,a as P}from"./QTable.ff5ff233.js";import{Q as E}from"./QSpinnerBall.16c3a4f2.js";import{a as c,s as h}from"./axios.23fd2c5d.js";import"./selection.4860df2b.js";import"./QList.35154e5b.js";const F=N({setup(){const e=d([]),a=d([]),m=d(""),l=d({id:null,nombre:"",nit:"",contador:"",activo:!0}),v=[{name:"nombre",label:"Nombre",field:"nombre_contribuyente",align:"left"},{name:"nit",label:"NIT",field:"nit",align:"left"},{name:"contador",label:"Contador",field:"contador",align:"left"},{name:"activo",label:"Activo",field:"activo",align:"left",format:o=>o?"S\xED":"No"},{name:"acciones",label:"Acciones",field:"",align:"center",style:"width:100px"}],b=()=>{u.show({message:"Cargando contribuyentes"}),c.get("/contribuyentes").then(o=>{e.value=o.data,u.hide()})},n=()=>{c.get("/contadores").then(o=>{a.value=o.data})},y=async()=>{const o=$.getItem("user");if(u.show({message:"Guardando...",spinner:E}),l.value.id===null){const r={_nombre_contribuyente:l.value.nombre,_nit:l.value.nit,_idcontador:l.value.contador,_us_crea:o,_id:0,_activo:!0};await c.post("/contribuyentes",r).then(Q=>{h("Contribuyente guardado correctamente.",{})})}else{const r={_id:l.value.id,_nombre_contribuyente:l.value.nombre,_nit:l.value.nit,_idcontador:l.value.contador,_activo:l.value.activo,_us_crea:o};await c.put("/contribuyentes",r).then(Q=>{h("Contribuyente actualizado correctamente.",{})})}u.hide(),b(),C()},w=o=>{l.value={id:o.id,nombre:o.nombre_contribuyente,nit:o.nit,contador:o.idcontador,activo:o.activo}},V=o=>{e.value=e.value.filter(r=>r.id!==o)},C=()=>{l.value={id:null,nombre:"",nit:"",contador:"",activo:!0}};return{contribuyentes:e,contadores:a,form:l,filtro:m,columns:v,resetForm:C,getContribuyentes:b,getContadores:n,guardarContribuyente:y,editarContribuyente:w,eliminarContribuyente:V,filtrarContribuyentes:()=>{const o=m.value.toLowerCase();return e.value.filter(r=>r.nombre_contribuyente.toLowerCase().includes(o)||r.nit.toLowerCase().includes(o)||(r.activo?"s\xED":"no").includes(o))}}},mounted(){this.getContadores(),this.getContribuyentes()}}),D={class:"q-pa-md"},G={class:"row q-gutter-sm"},j={class:"col-6"},z={class:"col-5"},M={class:"col-9"},H={class:"col-2"},J=s("div",{class:"col-12"},null,-1),K={class:"col-12 text-center q-pa-md q-gutter-md"},O=s("div",{class:"text-h5"},"Contribuyentes",-1);function R(e,a,m,l,v,b){return S(),q("div",D,[t(g,{class:"q-mt-md"},{default:i(()=>[t(_,null,{default:i(()=>[t(I,{onSubmit:A(e.guardarContribuyente,["prevent"])},{default:i(()=>[s("div",G,[s("div",j,[t(f,{modelValue:e.form.nombre,"onUpdate:modelValue":a[0]||(a[0]=n=>e.form.nombre=n),label:"Nombre del contribuyente",outlined:"",dense:""},null,8,["modelValue"])]),s("div",z,[t(f,{modelValue:e.form.nit,"onUpdate:modelValue":a[1]||(a[1]=n=>e.form.nit=n),label:"NIT",outlined:"",dense:""},null,8,["modelValue"])]),s("div",M,[t(U,{modelValue:e.form.contador,"onUpdate:modelValue":a[2]||(a[2]=n=>e.form.contador=n),options:e.contadores,label:"Contador",outlined:"",dense:"","emit-value":"","map-options":"","option-value":"idcontador","option-label":"nombre"},null,8,["modelValue","options"])]),s("div",H,[t(T,{modelValue:e.form.activo,"onUpdate:modelValue":a[3]||(a[3]=n=>e.form.activo=n),label:"Activo","left-label":"",class:"toggle-center-div-dense"},null,8,["modelValue"])]),J,s("div",K,[t(p,{type:"submit",label:"Guardar",color:"primary",push:"",class:"btn-fixed-width"}),t(p,{label:"Cancelar",color:"primary",flat:"",class:"btn-fixed-width",onClick:e.resetForm},null,8,["onClick"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1}),t(B,{spaced:"",dark:""}),t(g,{class:"my-card"},{default:i(()=>[t(_,null,{default:i(()=>[O,t(f,{modelValue:e.filtro,"onUpdate:modelValue":a[4]||(a[4]=n=>e.filtro=n),label:"Buscar Contribuyente",outlined:"",dense:"",class:"q-my-md"},null,8,["modelValue"]),t(L,{style:{height:"400px"},flat:"","virtual-scroll":"",separator:"cell",bordered:"","rows-per-page-options":[0],class:"my-sticky-header-table",rows:e.filtrarContribuyentes(),columns:e.columns,"row-key":"id"},{"body-cell-acciones":i(n=>[t(P,{props:n},{default:i(()=>[t(p,{icon:"edit",color:"primary",dense:"",onClick:y=>e.editarContribuyente(n.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})])}var ae=k(F,[["render",R]]);export{ae as default};
