import{Q as k,a as b}from"./QBreadcrumbs.05866da9.js";import{_ as F,d as q,g as n,o as D,c as G,e as l,w as s,Q as w,a as m,i as C,aI as L,f as i,j as f,aH as T,ba as g,l as _}from"./index.e0c1063c.js";import{h as v}from"./QSelect.a378caa7.js";import{Q as $}from"./QForm.3166fd63.js";import{Q as A,a as H}from"./QTable.6bb2999b.js";import{Q as P}from"./QSpinnerBall.eb0be42f.js";import{a as u,s as Q}from"./axios.365a50f5.js";import"./selection.aa18812a.js";import"./QList.bad91cd7.js";const I=q({setup(o,{emit:t}){const d=n([]),p=n([]),y=n([{id:1,tipo_empresa:"Contibuyente Normal"},{id:2,tipo_empresa:"Peque\xF1o Contribuyente"}]),V=n([{id:1,tipo:"Bienes"},{id:2,tipo:"Servicios"}]),e=n({id:null,nombre:"",contribuyente:"",tipoempresa:"",flag_gasolinera:!1,flag_hotel:!1,activo:!0,distribucionVentas:"",codigo_establecimiento:null}),c=n(""),S=[{name:"nombre",label:"Nombre",field:"nombre_empresa",align:"left"},{name:"contribuyente",label:"Contribuyente",field:"nombre_contribuyente",align:"left"},{name:"tipoempresa",label:"Tipo de Empresa",field:"idtipoempresa",align:"left"},{name:"flag_gasolinera",label:"Es Gasolinera",field:"flag_gasolinera",align:"left",format:a=>a?"S\xED":"No"},{name:"flag_hotel",label:"Es Hotel",field:"flag_hotel",align:"left",format:a=>a?"S\xED":"No"},{name:"activo",label:"Activo",field:"activo",align:"left",format:a=>a?"S\xED":"No"},{name:"distribucion",label:"Distribucion Ventas",field:"distribucion",align:"left"},{name:"acciones",label:"Acciones",field:"",align:"center",style:"width:100px"}],N=()=>{u.get("/contribuyentes").then(a=>{p.value=a.data})},h=()=>{m.show({message:"Cargando empresas"}),u.get("/empresas").then(a=>{d.value=a.data,m.hide()})},B=async()=>{if(m.show({message:"Guardando...",spinner:P}),e.value.id===null){const a={_nombre_empresa:e.value.nombre,_idcontribuyente:e.value.contribuyente,_idtipoempresa:e.value.tipoempresa,_flag_gasolinera:e.value.flag_gasolinera,_flag_hotel:e.value.flag_hotel,_us_crea:"usrtest",_flag_activo:!0,_idEmpresa:0,_distribucion:e.value.distribucionVentas,_codigo_establecimiento:Number(e.value.codigo_establecimiento)};await u.post("empresas",a).then(r=>{Q("Empresa guardada correctamente!")})}else{const a={_nombre_empresa:e.value.nombre,_idcontribuyente:e.value.contribuyente,_idtipoempresa:e.value.tipoempresa,_flag_gasolinera:e.value.flag_gasolinera,_flag_hotel:e.value.flag_hotel,_us_crea:"usrtest",_flag_activo:e.value.activo,_idEmpresa:e.value.id,_distribucion:e.value.distribucionVentas,_codigo_establecimiento:Number(e.value.codigo_establecimiento)};await u.put("empresas",a).then(r=>{Q("Empresa guardada correctamente!")}),t("empresa-agregada",a)}m.hide(),h(),E()},U=a=>{e.value={id:a.id,nombre:a.nombre_empresa,contribuyente:a.idcontribuyente,tipoempresa:a.idtipoempresa,flag_gasolinera:a.flag_gasolinera,flag_hotel:a.flag_hotel,activo:a.activo,distribucionVentas:a.distribucion,codigo_establecimiento:a.codigo_establecimiento}},E=()=>{e.value={id:null,nombre:"",contribuyente:"",tipoempresa:"",flag_gasolinera:!1,flag_hotel:!1,activo:!0,distribucionVentas:"",codigo_establecimiento:null}};return{empresas:d,contribuyentes:p,tiposEmpresa:y,form:e,filtro:c,columns:S,distribuciones:V,getContribuyentes:N,getEmpresas:h,resetForm:E,guardarEmpresa:B,editarEmpresa:U,filtrarEmpresas:()=>{const a=c.value.toLowerCase();return d.value.filter(r=>r.nombre_empresa.toLowerCase().includes(a)||r.idcontribuyente.toString().toLowerCase().includes(a)||r.idtipoempresa.toString().toLowerCase().includes(a))}}},mounted(){this.getEmpresas(),this.getContribuyentes()}}),j={class:"q-pa-sm"},M={class:"row q-col-gutter-sm"},z={class:"col-10"},J={class:"text-subtitle2"},K={class:"col-2"},O={class:"col-6"},R={class:"col-3"},W={class:"col-3"},X={class:"col-2"},Y={class:"col-4"},Z={class:"col-2"},x=i("div",{class:"col-12"},null,-1),ee={class:"col-12 text-center q-gutter-md"},oe=i("div",{class:"text-h5"},"Empresas",-1);function ae(o,t,d,p,y,V){return D(),G("div",j,[l(k,null,{default:s(()=>[l(b,{label:"Home",icon:"home"}),l(b,{label:"Configuraci\xF3n",icon:"settings"}),l(b,{label:"Gesti\xF3n de Empresas",icon:"apartment"})]),_:1}),l(w,{class:"q-mt-md"},{default:s(()=>[l(C,null,{default:s(()=>[l($,{onSubmit:L(o.guardarEmpresa,["prevent"])},{default:s(()=>[i("div",M,[i("div",z,[l(f,{modelValue:o.form.nombre,"onUpdate:modelValue":t[0]||(t[0]=e=>o.form.nombre=e),label:"Nombre de la empresa",outlined:"",dense:""},{prepend:s(()=>[i("div",J,T(o.form.id),1)]),_:1},8,["modelValue"])]),i("div",K,[l(f,{modelValue:o.form.codigo_establecimiento,"onUpdate:modelValue":t[1]||(t[1]=e=>o.form.codigo_establecimiento=e),type:"number",label:"C\xF3digo Establecimiento",outlined:"",dense:""},null,8,["modelValue"])]),i("div",O,[l(v,{modelValue:o.form.contribuyente,"onUpdate:modelValue":t[2]||(t[2]=e=>o.form.contribuyente=e),options:o.contribuyentes,label:"Contribuyente",outlined:"",dense:"","emit-value":"","map-options":"","option-value":"id","option-label":"nombre_contribuyente"},null,8,["modelValue","options"])]),i("div",R,[l(v,{modelValue:o.form.tipoempresa,"onUpdate:modelValue":t[3]||(t[3]=e=>o.form.tipoempresa=e),options:o.tiposEmpresa,label:"Tipo de Empresa",outlined:"",dense:"","emit-value":"","map-options":"","option-value":"id","option-label":"tipo_empresa"},null,8,["modelValue","options"])]),i("div",W,[l(v,{modelValue:o.form.distribucionVentas,"onUpdate:modelValue":t[4]||(t[4]=e=>o.form.distribucionVentas=e),options:o.distribuciones,label:"Distribuci\xF3n de ventas",outlined:"",dense:"","emit-value":"","map-options":"","option-value":"tipo","option-label":"tipo"},null,8,["modelValue","options"])]),i("div",X,[l(g,{modelValue:o.form.flag_gasolinera,"onUpdate:modelValue":t[5]||(t[5]=e=>o.form.flag_gasolinera=e),label:"Es Gasolinera"},null,8,["modelValue"])]),i("div",Y,[l(g,{modelValue:o.form.flag_hotel,"onUpdate:modelValue":t[6]||(t[6]=e=>o.form.flag_hotel=e),label:"Es Hotel"},null,8,["modelValue"])]),i("div",Z,[l(g,{modelValue:o.form.activo,"onUpdate:modelValue":t[7]||(t[7]=e=>o.form.activo=e),label:"Activo","left-label":"",class:"toggle-center-div-dense"},null,8,["modelValue"])]),x,i("div",ee,[l(_,{type:"submit",label:"Guardar",color:"primary",push:"",class:"btn-fixed-width"}),l(_,{label:"Cancelar",color:"primary",flat:"",class:"btn-fixed-width",onClick:o.resetForm},null,8,["onClick"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1}),l(w,{class:"q-my-md"},{default:s(()=>[l(C,null,{default:s(()=>[oe,l(f,{modelValue:o.filtro,"onUpdate:modelValue":t[8]||(t[8]=e=>o.filtro=e),label:"Buscar empresas",outlined:"",dense:"",class:"q-my-md"},null,8,["modelValue"]),l(A,{style:{height:"400px"},flat:"","virtual-scroll":"",separator:"cell",bordered:"","rows-per-page-options":[0],class:"my-sticky-header-table",rows:o.filtrarEmpresas(),columns:o.columns,"row-key":"id"},{"body-cell-acciones":s(e=>[l(H,{props:e},{default:s(()=>[l(_,{icon:"edit",color:"primary",dense:"",onClick:c=>o.editarEmpresa(e.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})])}var ce=F(I,[["render",ae]]);export{ce as default};
