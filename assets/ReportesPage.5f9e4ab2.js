import{y as n,I as O,bj as J,bk as H,_,d as ee,g as s,o as T,ax as le,w as d,a as b,P as A,f as t,e as a,i as G,bh as j,c as oe,aG as ae,j as I,Q as z,b7 as re,bv as i,l as C}from"./index.d9695857.js";import{h as M}from"./QSelect.c6280892.js";import{Q as te,a as B,b as ne,c as L}from"./QTabPanels.a0f28007.js";import{Q as se}from"./QPage.6f512fb8.js";import{a as V,s as f,d as ie}from"./axios.d44cf039.js";import"./selection.e66135a6.js";import"./QResizeObserver.6d09deb0.js";import"./use-render-cache.3aae9b27.js";const de=[n("circle",{cx:"15",cy:"15",r:"15"},[n("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),n("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]),n("circle",{cx:"60",cy:"15",r:"9","fill-opacity":".3"},[n("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),n("animate",{attributeName:"fill-opacity",from:".5",to:".5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})]),n("circle",{cx:"105",cy:"15",r:"15"},[n("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),n("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})])];var ue=O({name:"QSpinnerDots",props:J,setup(e){const{cSize:l,classes:p}=H(e);return()=>n("svg",{class:p.value,fill:"currentColor",width:l.value,height:l.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg"},de)}});const me=[n("g",{transform:"translate(-20,-20)"},[n("path",{d:"M79.9,52.6C80,51.8,80,50.9,80,50s0-1.8-0.1-2.6l-5.1-0.4c-0.3-2.4-0.9-4.6-1.8-6.7l4.2-2.9c-0.7-1.6-1.6-3.1-2.6-4.5 L70,35c-1.4-1.9-3.1-3.5-4.9-4.9l2.2-4.6c-1.4-1-2.9-1.9-4.5-2.6L59.8,27c-2.1-0.9-4.4-1.5-6.7-1.8l-0.4-5.1C51.8,20,50.9,20,50,20 s-1.8,0-2.6,0.1l-0.4,5.1c-2.4,0.3-4.6,0.9-6.7,1.8l-2.9-4.1c-1.6,0.7-3.1,1.6-4.5,2.6l2.1,4.6c-1.9,1.4-3.5,3.1-5,4.9l-4.5-2.1 c-1,1.4-1.9,2.9-2.6,4.5l4.1,2.9c-0.9,2.1-1.5,4.4-1.8,6.8l-5,0.4C20,48.2,20,49.1,20,50s0,1.8,0.1,2.6l5,0.4 c0.3,2.4,0.9,4.7,1.8,6.8l-4.1,2.9c0.7,1.6,1.6,3.1,2.6,4.5l4.5-2.1c1.4,1.9,3.1,3.5,5,4.9l-2.1,4.6c1.4,1,2.9,1.9,4.5,2.6l2.9-4.1 c2.1,0.9,4.4,1.5,6.7,1.8l0.4,5.1C48.2,80,49.1,80,50,80s1.8,0,2.6-0.1l0.4-5.1c2.3-0.3,4.6-0.9,6.7-1.8l2.9,4.2 c1.6-0.7,3.1-1.6,4.5-2.6L65,69.9c1.9-1.4,3.5-3,4.9-4.9l4.6,2.2c1-1.4,1.9-2.9,2.6-4.5L73,59.8c0.9-2.1,1.5-4.4,1.8-6.7L79.9,52.6 z M50,65c-8.3,0-15-6.7-15-15c0-8.3,6.7-15,15-15s15,6.7,15,15C65,58.3,58.3,65,50,65z",fill:"currentColor"},[n("animateTransform",{attributeName:"transform",type:"rotate",from:"90 50 50",to:"0 50 50",dur:"1s",repeatCount:"indefinite"})])]),n("g",{transform:"translate(20,20) rotate(15 50 50)"},[n("path",{d:"M79.9,52.6C80,51.8,80,50.9,80,50s0-1.8-0.1-2.6l-5.1-0.4c-0.3-2.4-0.9-4.6-1.8-6.7l4.2-2.9c-0.7-1.6-1.6-3.1-2.6-4.5 L70,35c-1.4-1.9-3.1-3.5-4.9-4.9l2.2-4.6c-1.4-1-2.9-1.9-4.5-2.6L59.8,27c-2.1-0.9-4.4-1.5-6.7-1.8l-0.4-5.1C51.8,20,50.9,20,50,20 s-1.8,0-2.6,0.1l-0.4,5.1c-2.4,0.3-4.6,0.9-6.7,1.8l-2.9-4.1c-1.6,0.7-3.1,1.6-4.5,2.6l2.1,4.6c-1.9,1.4-3.5,3.1-5,4.9l-4.5-2.1 c-1,1.4-1.9,2.9-2.6,4.5l4.1,2.9c-0.9,2.1-1.5,4.4-1.8,6.8l-5,0.4C20,48.2,20,49.1,20,50s0,1.8,0.1,2.6l5,0.4 c0.3,2.4,0.9,4.7,1.8,6.8l-4.1,2.9c0.7,1.6,1.6,3.1,2.6,4.5l4.5-2.1c1.4,1.9,3.1,3.5,5,4.9l-2.1,4.6c1.4,1,2.9,1.9,4.5,2.6l2.9-4.1 c2.1,0.9,4.4,1.5,6.7,1.8l0.4,5.1C48.2,80,49.1,80,50,80s1.8,0,2.6-0.1l0.4-5.1c2.3-0.3,4.6-0.9,6.7-1.8l2.9,4.2 c1.6-0.7,3.1-1.6,4.5-2.6L65,69.9c1.9-1.4,3.5-3,4.9-4.9l4.6,2.2c1-1.4,1.9-2.9,2.6-4.5L73,59.8c0.9-2.1,1.5-4.4,1.8-6.7L79.9,52.6 z M50,65c-8.3,0-15-6.7-15-15c0-8.3,6.7-15,15-15s15,6.7,15,15C65,58.3,58.3,65,50,65z",fill:"currentColor"},[n("animateTransform",{attributeName:"transform",type:"rotate",from:"0 50 50",to:"90 50 50",dur:"1s",repeatCount:"indefinite"})])])];var pe=O({name:"QSpinnerGears",props:J,setup(e){const{cSize:l,classes:p}=H(e);return()=>n("svg",{class:p.value,width:l.value,height:l.value,viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",xmlns:"http://www.w3.org/2000/svg"},me)}});const ve=ee({setup(){const e=s("periodo"),l=s("diario"),p=s("diario"),w=s([]),P=s([]),U=s([]),o=s(""),S=s(null),F=s(null),E=s(1),k=s(),Y=s(!1),r=s({contribuyente:null,empresa:null,periodo:null,hastaCuenta:"",desdeCuenta:""}),K=()=>{r.value.contribuyente=null,r.value.empresa=null,r.value.periodo=null,r.value.hastaCuenta="",r.value.desdeCuenta=""},W=async()=>{K(),await V.get("/contribuyentes").then(u=>{w.value=u.data})},D=async()=>{r.value.empresa=null,r.value.periodo=null,r.value.hastaCuenta="",r.value.desdeCuenta="",b.show({message:"Cargando empresas"}),await V.get("/empresas/contribuyente",{params:{id_contribuyente:r.value.contribuyente.id}}).then(u=>{P.value=u.data,b.hide()})},$=async()=>{r.value.empresa&&(r.value.periodo=null,await V.get("/periodos/all/"+r.value.empresa.id).then(u=>{U.value=u.data}))};return{acualizarFolioEmpresa:async()=>{await V.put("/empresas/folio",{_idempresa:r.value.empresa.id,_folio:E.value}).then(u=>{f("Folio actualizado correctamente",{tipo:"positive"})})},mesInicial:S,mesFinal:F,generarReporte:async()=>{const{contribuyente:u,empresa:Q,periodo:c,hastaCuenta:h,desdeCuenta:q}=r.value;let m=S.value?S.value.value:null,y=F.value?F.value.value:null;if(!u||!Q){f("Contribuyente y Empresa son obligatorios.",{tipo:"negative"});return}if(!c){f("Debe seleccionar un periodo, el periodo es obligatorio.",{tipo:"negative"});return}if(e.value==="mes"){if(!m||!y){f("Mes Inicial y Mes Final son obligatorios.",{tipo:"negative"});return}if(m&&y&&m>y){f("Mes Inicial no puede ser mayor que Mes Final.",{tipo:"negative"});return}}else m=1,y=12;let g="",R="",N=!1;if(e.value=="periodo"?(g=l.value,R="xperiodo_report"):e.value=="mes"&&(R="xmes_report",g=p.value),console.log(`/reportes/${g}`),b.show({message:"Obteniendo informaci\xF3n",spinner:ue}),await V.get(`/reportes/${g}`,{params:{contribuyente:u.id,empresa:Q.id,periodo:c.periodo,mesInicio:m,mesFin:y}}).then(v=>{if(console.log("\u{1F680} ~ .then reportes ~ resp.data:",v.data),!v.data.periodo){f("No se encontraron datos para el reporte",{tipo:"negative"}),b.hide(),N=!0;return}k.value=v.data}).catch(v=>{f(v),b.hide(),N=!0}),N)return;let X={reporte:`${g}${R}`,data:k.value},Z="";b.show({message:"Construyendo reporte ",spinner:pe}),await V.post(ie+Z,X,{responseType:"blob"}).then(async v=>{const x=URL.createObjectURL(v.data);o.value=x}).finally(()=>{b.hide()})},scrReport:o,periodos:U,selectEmpresa:()=>{$(),E.value=r.value.empresa.correlativo_folio===null?1:r.value.empresa.correlativo_folio},getEmpresas:D,getContribuyentes:W,setEmpresaSes:async()=>{let u=JSON.parse(A.getItem("empresa")||"{}"),Q=w.value.find(m=>m.id===u.idcontribuyente);r.value.contribuyente=Q,await D();let c=P.value.find(m=>m.id===u.id);r.value.empresa=c,E.value=c.correlativo_folio===null?1:c.correlativo_folio;let h=A.getItem("periodo");await $();let q=U.value.find(m=>m.periodo===h);r.value.periodo=q},porContribuyente:Y,contribuyentes:w,empresas:P,form:r,folio:E,periodo:2023,mes:"",cuenta:"",proveedor:"",monto:null,sinMovimiento:s(!1),tab:e,reportePeriodo:l,reporteMes:p,meses:[{label:"Enero",value:1},{label:"Febrero",value:2},{label:"Marzo",value:3},{label:"Abril",value:4},{label:"Mayo",value:5},{label:"Junio",value:6},{label:"Julio",value:7},{label:"Agosto",value:8},{label:"Septiembre",value:9},{label:"Octubre",value:10},{label:"Noviembre",value:11},{label:"Diciembre",value:12}]}},async mounted(){await this.getContribuyentes(),this.setEmpresaSes()},watch:{}}),be={class:"row fit"},fe={class:""},ce={class:"row"},Ve={class:"col-xs-12 col-md-4"},ye={key:0,class:"row q-col-gutter-sm q-mb-sm"},ge={class:"col-xs-12 col-md-12"},Ce={class:"col-xs-12 col-md-12"},Me={class:"row q-col-gutter-sm"},we={class:"col-xs-12 col-md-6"},Pe={class:"col-xs-12 col-md-6"},Ue={class:"col-xs-12 col-md-6"},Ee={class:"col-xs-12 col-md-6"},Qe={class:"col-xs-12 col-md-6"},Se=t("div",{class:"row q-col-gutter-sm"},null,-1),Fe=t("br",null,null,-1),Re=t("br",null,null,-1),Ne={class:"row justify-end q-gutter-sm"},Ie=["src"];function ze(e,l,p,w,P,U){return T(),le(se,null,{default:d(()=>[t("div",be,[a(z,{class:"col-xs-12 col-md-5"},{default:d(()=>[a(G,null,{default:d(()=>[t("div",fe,[t("div",ce,[a(j,{"left-label":"",modelValue:e.porContribuyente,"onUpdate:modelValue":l[0]||(l[0]=o=>e.porContribuyente=o),label:"Por contribuyente",class:"col-6"},null,8,["modelValue"]),t("div",Ve,[a(M,{label:"Per\xEDodo",modelValue:e.form.periodo,"onUpdate:modelValue":l[1]||(l[1]=o=>e.form.periodo=o),options:e.periodos,outlined:"",dense:"","option-label":"periodo","option-value":"periodo"},null,8,["modelValue","options"])])]),e.porContribuyente?(T(),oe("div",ye,[t("div",ge,[a(M,{label:"Contribuyente",modelValue:e.form.contribuyente,"onUpdate:modelValue":[l[2]||(l[2]=o=>e.form.contribuyente=o),e.getEmpresas],outlined:"",dense:"",options:e.contribuyentes,"option-value":"id","option-label":"nombre_contribuyente"},null,8,["modelValue","options","onUpdate:modelValue"])]),t("div",Ce,[a(M,{label:"Empresa",modelValue:e.form.empresa,"onUpdate:modelValue":[l[3]||(l[3]=o=>e.form.empresa=o),e.selectEmpresa],outlined:"",dense:"",options:e.empresas,"option-value":"id","option-label":"nombre_empresa"},null,8,["modelValue","options","onUpdate:modelValue"])])])):ae("",!0),t("div",Me,[t("div",we,[a(I,{label:"Desde Cta.",modelValue:e.form.desdeCuenta,"onUpdate:modelValue":l[4]||(l[4]=o=>e.form.desdeCuenta=o),type:"text",outlined:"",dense:""},null,8,["modelValue"])]),t("div",Pe,[a(I,{label:"Hasta Cta.",modelValue:e.form.hastaCuenta,"onUpdate:modelValue":l[5]||(l[5]=o=>e.form.hastaCuenta=o),type:"text",outlined:"",dense:""},null,8,["modelValue"])]),t("div",Ue,[a(M,{label:"Mes Inicial",modelValue:e.mesInicial,"onUpdate:modelValue":l[6]||(l[6]=o=>e.mesInicial=o),options:e.meses,"option-label":"label","option-value":"value",outlined:"",dense:""},null,8,["modelValue","options"])]),t("div",Ee,[a(M,{label:"Mes Final",modelValue:e.mesFinal,"onUpdate:modelValue":l[7]||(l[7]=o=>e.mesFinal=o),options:e.meses,"option-label":"label","option-value":"value",outlined:"",dense:""},null,8,["modelValue","options"])]),t("div",Qe,[a(j,{modelValue:e.sinMovimiento,"onUpdate:modelValue":l[8]||(l[8]=o=>e.sinMovimiento=o),label:"Sin Movimiento"},null,8,["modelValue"])])]),Se]),Fe,a(z,null,{default:d(()=>[a(te,{modelValue:e.tab,"onUpdate:modelValue":l[9]||(l[9]=o=>e.tab=o),class:"text-bold"},{default:d(()=>[a(B,{name:"periodo",label:"Por Periodo"}),a(B,{name:"mes",label:"Por Mes"}),a(B,{name:"compras",label:"Compras y Ventas"})]),_:1},8,["modelValue"]),a(re),a(ne,{modelValue:e.tab,"onUpdate:modelValue":l[24]||(l[24]=o=>e.tab=o),animated:""},{default:d(()=>[a(L,{name:"periodo"},{default:d(()=>[a(i,{modelValue:e.reportePeriodo,"onUpdate:modelValue":l[10]||(l[10]=o=>e.reportePeriodo=o),val:"diario",label:"Diario"},null,8,["modelValue"]),a(i,{modelValue:e.reportePeriodo,"onUpdate:modelValue":l[11]||(l[11]=o=>e.reportePeriodo=o),val:"mayor",label:"Mayor"},null,8,["modelValue"]),a(i,{modelValue:e.reportePeriodo,"onUpdate:modelValue":l[12]||(l[12]=o=>e.reportePeriodo=o),val:"balance",label:"Balance"},null,8,["modelValue"]),a(i,{modelValue:e.reportePeriodo,"onUpdate:modelValue":l[13]||(l[13]=o=>e.reportePeriodo=o),val:"er_consolidado",label:"ER Consolidado"},null,8,["modelValue"]),a(i,{modelValue:e.reportePeriodo,"onUpdate:modelValue":l[14]||(l[14]=o=>e.reportePeriodo=o),val:"er_analitico",label:"ER Anal\xEDtio"},null,8,["modelValue"]),a(i,{modelValue:e.reportePeriodo,"onUpdate:modelValue":l[15]||(l[15]=o=>e.reportePeriodo=o),val:"balance_generalC",label:"BG Consolidado"},null,8,["modelValue"]),a(i,{modelValue:e.reportePeriodo,"onUpdate:modelValue":l[16]||(l[16]=o=>e.reportePeriodo=o),val:"balance_generalA",label:"BG Anal\xEDtico"},null,8,["modelValue"]),a(i,{modelValue:e.reportePeriodo,"onUpdate:modelValue":l[17]||(l[17]=o=>e.reportePeriodo=o),val:"flujo_efectivo",label:"Flujo de Efectivo"},null,8,["modelValue"])]),_:1}),a(L,{name:"mes"},{default:d(()=>[a(i,{modelValue:e.reporteMes,"onUpdate:modelValue":l[18]||(l[18]=o=>e.reporteMes=o),val:"diario",label:"Diario"},null,8,["modelValue"]),a(i,{modelValue:e.reporteMes,"onUpdate:modelValue":l[19]||(l[19]=o=>e.reporteMes=o),val:"mayor",label:"Mayor"},null,8,["modelValue"]),a(i,{modelValue:e.reporteMes,"onUpdate:modelValue":l[20]||(l[20]=o=>e.reporteMes=o),val:"balance",label:"Balance"},null,8,["modelValue"]),a(i,{modelValue:e.reporteMes,"onUpdate:modelValue":l[21]||(l[21]=o=>e.reporteMes=o),val:"estadoresultados",label:"Est. Resultados"},null,8,["modelValue"]),a(i,{modelValue:e.reporteMes,"onUpdate:modelValue":l[22]||(l[22]=o=>e.reporteMes=o),val:"balance_general",label:"Balance General"},null,8,["modelValue"]),a(i,{modelValue:e.reporteMes,"onUpdate:modelValue":l[23]||(l[23]=o=>e.reporteMes=o),val:"inventarios",label:"Inventarios"},null,8,["modelValue"])]),_:1}),a(L,{name:"compras"},{default:d(()=>[a(C,{label:"Compras",color:"primary"}),a(C,{label:"Ventas",color:"primary"})]),_:1})]),_:1},8,["modelValue"])]),_:1}),Re,t("div",Ne,[a(I,{modelValue:e.folio,"onUpdate:modelValue":l[27]||(l[27]=o=>e.folio=o),type:"number",label:"No. Folio",outlined:"",dense:"","hide-bottom-space":"",readonly:"",class:"col-4",rules:[o=>o>0||"No puede ser un folio negativo"]},{before:d(()=>[a(C,{round:"",dense:"",flat:"",icon:"remove",onClick:l[25]||(l[25]=()=>{e.folio<=1||e.folio--,e.acualizarFolioEmpresa()}),color:"red"})]),after:d(()=>[a(C,{round:"",dense:"",flat:"",icon:"add",onClick:l[26]||(l[26]=()=>{e.folio++,e.acualizarFolioEmpresa()}),color:"blue"})]),_:1},8,["modelValue","rules"]),a(C,{label:"Generar Reporte",color:"primary",onClick:e.generarReporte},null,8,["onClick"])])]),_:1})]),_:1}),a(z,{class:"col-xs-12 col-md-7 q-pa-none"},{default:d(()=>[a(G,{class:"q-pa-none"},{default:d(()=>[t("iframe",{name:"reporte",src:e.scrReport,width:"100%",style:{height:"90vh"}},null,8,Ie)]),_:1})]),_:1})])]),_:1})}var Je=_(ve,[["render",ze]]);export{Je as default};
