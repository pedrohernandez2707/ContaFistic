import{_ as y,d as C,g as t,aZ as Q,o as h,c as k,e as l,w as n,Q as _,i as b,aA as B,f as r,j as d,b8 as S,b7 as V,C as q,l as g}from"./index.d9695857.js";import{h as P}from"./QSelect.c6280892.js";import{Q as $}from"./QForm.d96e864f.js";import{Q as A,a as E}from"./QTable.51545b81.js";import{u as I}from"./use-quasar.ece646d1.js";import{a as p}from"./axios.d44cf039.js";import"./selection.e66135a6.js";import"./QList.88bd2d48.js";const N=C({setup(){const e=I(),a=t([{id:1,nombre:"Usuario 1",email:"usuario1@example.com",activo:!0},{id:2,nombre:"Usuario 2",email:"usuario2@example.com",activo:!1}]),o=t({codigo_usuario:null,usuario:"",tipo_usuario:"",estado_usuario:!0,nombres_usuario:"",contrasena:"",direccion_usuario:"",telefono_usuario:"",correo_usuario:""}),m=t(""),f=[{name:"nombre",label:"Nombre",field:"nombre",align:"left"},{name:"email",label:"Email",field:"email",align:"left"},{name:"activo",label:"Activo",field:"activo",align:"left",format:i=>i?"S\xED":"No"},{name:"acciones",label:"Acciones",field:"",align:"center",style:"width:100px"}],v=()=>{if(o.value.codigo_usuario){const i={p_id_usuario:parseInt(o.value.codigo_usuario),p_nombre_usuario:o.value.nombres_usuario,p_usuario:o.value.usuario,p_contrasena:o.value.contrasena,p_direccion:o.value.direccion_usuario===void 0?"":o.value.direccion_usuario,p_telefono:o.value.telefono_usuario===void 0?"":o.value.telefono_usuario,p_correo:o.value.correo_usuario===void 0?"":o.value.correo_usuario,p_estado:o.value.estado_usuario?"A":"I"};p.put("/users",i).then(u=>{e.notify({message:"Usuario actualizado correctamente",color:"primary",position:"center",icon:"info",actions:[{label:"Ok",color:"white",handler:()=>{}}]})})}else{const i={p_nombre_usuario:o.value.nombres_usuario,p_usuario:o.value.usuario,p_contrasena:o.value.contrasena,p_direccion:o.value.direccion_usuario,p_telefono:o.value.telefono_usuario,p_correo:o.value.correo_usuario,p_id_rol:parseInt(o.value.tipo_usuario.toString())};p.post("/users",i).then(u=>{e.notify({message:"Usuario creado correctamente",color:"primary",position:"center",icon:"info",actions:[{label:"Ok",color:"white",handler:()=>{}}]})})}c()},s=Q(async()=>{o.value.codigo_usuario?await p.get("/users/"+o.value.codigo_usuario).then(i=>{let u=i.data;o.value.nombres_usuario=u.nombre_usuario,o.value.usuario=u.usuario,o.value.direccion_usuario=u.direccion,o.value.telefono_usuario=u.telefono_,o.value.correo_usuario=u.correo,o.value.estado_usuario=u.estado==="A"}):c()},1e3),c=()=>{o.value.codigo_usuario=null,o.value.nombres_usuario="",o.value.contrasena="",o.value.usuario="",o.value.direccion_usuario="",o.value.telefono_usuario="",o.value.correo_usuario=""},U=i=>{o.value={...i}},w=()=>{const i=m.value.toLowerCase();return a.value.filter(u=>u.nombre.toLowerCase().includes(i)||u.email.toLowerCase().includes(i)||(u.activo?"s\xED":"no").includes(i))};return{isPwd:t(!0),usuarios:a,form:o,columns:f,filtro:m,guardarUsuario:v,editarUsuario:U,debouncedBuscarUsuario:s,filtrarUsuarios:w}}}),T={class:"q-pa-sm"},D={class:"row"},F={class:"col-xs-12 col-sm-2"},L={class:"col-xs-12 col-sm-8"},M={class:"col col-xs-12 col-sm-2"},j={class:"row"},z={class:"col-xs-12 col-sm-4"},O={class:"col-xs-12 col-sm-4"},G={class:"col-xs-12 col-sm-4"},Z={class:"row"},H={class:"col-xs-12 col-sm-8"},J={class:"col-xs-12 col-sm-4"},K={class:"row"},R={class:"col-xs-12 col-sm-5 col-md-5"},W={class:"row justify-center q-ma-md"},X={class:"col-2"},Y=r("div",{class:"text-h5"},"Usuarios",-1),x={style:{height:"400px","overflow-y":"auto"}};function oo(e,a,o,m,f,v){return h(),k("div",T,[l(_,null,{default:n(()=>[l(b,null,{default:n(()=>[l($,{onSubmit:B(e.guardarUsuario,["prevent"])},{default:n(()=>[r("div",D,[r("div",F,[l(d,{modelValue:e.form.codigo_usuario,"onUpdate:modelValue":[a[0]||(a[0]=s=>e.form.codigo_usuario=s),e.debouncedBuscarUsuario],label:"C\xF3digo Usuario",outlined:"",dense:"",disable:""},null,8,["modelValue","onUpdate:modelValue"])]),r("div",L,[l(d,{modelValue:e.form.nombres_usuario,"onUpdate:modelValue":a[1]||(a[1]=s=>e.form.nombres_usuario=s),label:"Nombre del usuario",outlined:"",dense:""},null,8,["modelValue"])]),r("div",M,[l(S,{label:"Estado",modelValue:e.form.estado_usuario,"onUpdate:modelValue":a[2]||(a[2]=s=>e.form.estado_usuario=s),color:"green",class:"q-ma-sm",dense:"",disable:!e.form.codigo_usuario,"left-label":""},null,8,["modelValue","disable"])])]),l(V,{spaced:"",inset:""}),r("div",j,[r("div",z,[l(d,{modelValue:e.form.usuario,"onUpdate:modelValue":a[3]||(a[3]=s=>e.form.usuario=s),label:"Usuario para el sistema",outlined:"",dense:""},null,8,["modelValue"])]),r("div",O,[l(d,{modelValue:e.form.contrasena,"onUpdate:modelValue":a[5]||(a[5]=s=>e.form.contrasena=s),label:"Contrase\xF1a para el sistema",outlined:"",dense:"",type:e.isPwd?"password":"text"},{append:n(()=>[l(q,{name:e.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:a[4]||(a[4]=s=>e.isPwd=!e.isPwd)},null,8,["name"])]),_:1},8,["modelValue","type"])]),r("div",G,[l(P,{modelValue:e.form.tipo_usuario,"onUpdate:modelValue":a[6]||(a[6]=s=>e.form.tipo_usuario=s),options:e.roles,label:"Tipo de Usuario",dense:"",outlined:"","emit-value":"","map-options":"","option-label":"nombre_rol","option-value":"id_rol",disable:!!e.form.codigo_usuario},null,8,["modelValue","options","disable"])])]),l(V,{spaced:""}),r("div",Z,[r("div",H,[l(d,{modelValue:e.form.direccion_usuario,"onUpdate:modelValue":a[7]||(a[7]=s=>e.form.direccion_usuario=s),label:"Direcci\xF3n",outlined:"",dense:""},null,8,["modelValue"])]),r("div",J,[l(d,{modelValue:e.form.telefono_usuario,"onUpdate:modelValue":a[8]||(a[8]=s=>e.form.telefono_usuario=s),label:"Telefono",outlined:"",dense:""},null,8,["modelValue"])])]),r("div",K,[r("div",R,[l(d,{modelValue:e.form.correo_usuario,"onUpdate:modelValue":a[9]||(a[9]=s=>e.form.correo_usuario=s),label:"Correo",outlined:"",dense:""},null,8,["modelValue"])])]),r("div",W,[r("div",X,[l(g,{type:"submit",label:e.form.codigo_usuario?"Guardar Usuario":"Crear Usuario",color:"primary",size:"md",outline:"",rounded:""},null,8,["label"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1}),l(_,{class:"q-my-md"},{default:n(()=>[l(b,null,{default:n(()=>[Y,l(d,{modelValue:e.filtro,"onUpdate:modelValue":a[10]||(a[10]=s=>e.filtro=s),label:"Buscar usuarios",outlined:"",dense:"",class:"q-my-md"},null,8,["modelValue"]),r("div",x,[l(A,{style:{height:"400px"},flat:"","virtual-scroll":"",separator:"cell",bordered:"","rows-per-page-options":[0],class:"my-sticky-header-table",rows:e.filtrarUsuarios(),columns:e.columns,"row-key":"id"},{"body-cell-acciones":n(s=>[l(E,{props:s},{default:n(()=>[l(g,{icon:"edit",color:"primary",dense:"",onClick:c=>e.editarUsuario(s.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])])]),_:1})]),_:1})])}var to=y(N,[["render",oo]]);export{to as default};
