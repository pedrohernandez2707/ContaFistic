import{_ as S,d as k,g as u,o as q,ax as B,w as r,P as U,a as d,e as t,i as h,aA as $,f as i,j as c,b8 as A,l as p,Q as w}from"./index.762d07e4.js";import{h as D}from"./QSelect.fdb0a187.js";import{Q as P}from"./QForm.97d69fac.js";import{Q as I,a as E}from"./QTable.af352f9e.js";import{Q as F}from"./QPage.933a530a.js";import{Q as L}from"./QSpinnerBall.99026ed7.js";import{a as v,s as V}from"./axios.3e09c041.js";import"./selection.a5915eb9.js";import"./QList.144654f9.js";const T=k({setup(){const e=u([]),a=u([]),m=u(!1),b=()=>{const l=U.getItem("empresa");let s;if(l)s=JSON.parse(l.toString()).id;else{alert("Debe seleccionar una empresa");return}d.show({message:"Cargando cuentas..."}),v.get("cuentasn1",{params:{id_empresa:s}}).then(_=>{e.value=_.data,d.hide()})},f=()=>{d.show({message:"Cargando cuentas nivel 2..."}),v.get("cuentasn2").then(l=>{a.value=l.data,d.hide()})},n=u({id:null,nombre:"",id_nivel1:null,correlativo:"",activo:!1}),o=u(""),g=[{name:"id",label:"ID",field:"id",align:"left"},{name:"nombre",label:"Nombre",field:"nombre",align:"left"},{name:"id_nivel1",label:"ID Nivel 1",field:"id_nivel1",align:"left"},{name:"nombre_nivel1",label:"Nombre Nivel 1",field:"nombre_nivel1",align:"left"},{name:"correlativo",label:"Correlativo",field:"correlativo",align:"left"},{name:"activo",label:"Activo",field:"activo",align:"left",format:l=>l?"S\xED":"No"},{name:"acciones",label:"Acciones",field:"",align:"center"}],Q=async()=>{if(d.show({message:"Guardando cuenta...",spinner:L}),n.value.id===null||n.value.id===""){const l={_nombre:n.value.nombre,_id_nivel1:n.value.id_nivel1,_us_crea:"usrtest",_id:0,_activo:!0};await v.post("cuentasn2",l).then(s=>{V("Cuenta nivel 2 guardada correctamente.")})}else{const l={_nombre:n.value.nombre,_id_nivel1:n.value.id_nivel1,_us_crea:"usrtest",_id:n.value.id,_activo:n.value.activo};await v.put("cuentasn2",l).then(s=>{V("Cuenta nivel 2 guardada correctamente.")})}d.hide(),f(),C()},N=l=>{n.value={...l},m.value=!0},y=l=>{a.value=a.value.filter(s=>s.id!==l)},C=()=>{n.value={id:null,nombre:"",id_nivel1:null,correlativo:"",activo:!1},m.value=!1};return{cuentasNivel1:e,cuentas:a,form:n,filtro:o,columns:g,resetForm:C,getCuentasn1:b,getCuentasn2:f,guardarCuenta:Q,editarCuenta:N,eliminarCuenta:y,filtrarCuentas:()=>{const l=o.value.toLowerCase();return a.value.filter(s=>s.id.toString().includes(l)||s.nombre.toLowerCase().includes(l)||s.id_nivel1.toString().includes(l)||s.correlativo.toString().includes(l)||(s.activo?"s\xED":"no").includes(l))},disableCuentasN1:m}},mounted(){this.getCuentasn1(),this.getCuentasn2()}}),G={class:"row q-col-gutter-sm"},j={class:"col-2"},J={class:"col-10"},M={class:"col-6"},O={class:"col-4"},z={class:"col-1"},H=i("div",{class:"col-12"},null,-1),K={class:"col-12 text-center q-gutter-sm"},R=i("div",{class:"text-h5"},"Cuentas nivel 2",-1);function W(e,a,m,b,f,n){return q(),B(F,{padding:""},{default:r(()=>[t(w,{class:"q-mt-md"},{default:r(()=>[t(h,null,{default:r(()=>[t(P,{onSubmit:$(e.guardarCuenta,["prevent"])},{default:r(()=>[i("div",G,[i("div",j,[t(c,{modelValue:e.form.id,"onUpdate:modelValue":a[0]||(a[0]=o=>e.form.id=o),label:"Codigo",outlined:"",dense:"",disable:""},null,8,["modelValue"])]),i("div",J,[t(c,{modelValue:e.form.nombre,"onUpdate:modelValue":a[1]||(a[1]=o=>e.form.nombre=o),label:"Nombre",outlined:"",dense:""},null,8,["modelValue"])]),i("div",M,[t(D,{modelValue:e.form.id_nivel1,"onUpdate:modelValue":a[2]||(a[2]=o=>e.form.id_nivel1=o),options:e.cuentasNivel1,label:"Cuenta Nivel 1",outlined:"",dense:"","emit-value":"","map-options":"","option-value":"id","option-label":"nombre",disable:e.disableCuentasN1},null,8,["modelValue","options","disable"])]),i("div",O,[t(c,{modelValue:e.form.correlativo,"onUpdate:modelValue":a[3]||(a[3]=o=>e.form.correlativo=o),label:"Correlativo",outlined:"",dense:"",disable:""},null,8,["modelValue"])]),i("div",z,[t(A,{modelValue:e.form.activo,"onUpdate:modelValue":a[4]||(a[4]=o=>e.form.activo=o),label:"Activo","left-label":"",class:"q-pl-md toggle-center-div-dense"},null,8,["modelValue"])]),H,i("div",K,[t(p,{type:"submit",label:"Guardar",color:"primary",push:"",class:"btn-fixed-width",disable:!0}),t(p,{label:"Cancelar",color:"primary",flat:"",class:"btn-fixed-width",onClick:e.resetForm},null,8,["onClick"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1}),t(w,{class:"q-my-md"},{default:r(()=>[t(h,null,{default:r(()=>[R,t(c,{modelValue:e.filtro,"onUpdate:modelValue":a[5]||(a[5]=o=>e.filtro=o),label:"Buscar",outlined:"",dense:"",class:"q-my-md"},null,8,["modelValue"]),t(I,{style:{height:"400px"},flat:"","virtual-scroll":"",separator:"cell",bordered:"","rows-per-page-options":[0],class:"my-sticky-header-table",rows:e.filtrarCuentas(),columns:e.columns,"row-key":"id"},{"body-cell-acciones":r(o=>[t(E,{props:o},{default:r(()=>[t(p,{icon:"edit",color:"primary",dense:"",onClick:g=>e.editarCuenta(o.row),disable:!0},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})]),_:1})}var se=S(T,[["render",W]]);export{se as default};
