import{a as p,Q as k}from"./QBreadcrumbs.146d315b.js";import{_ as B,d as q,g as u,o as F,aF as U,w as i,P as $,a as d,e as a,i as w,aI as D,f as r,j as c,ba as I,l as b,Q as V}from"./index.91e6d4f7.js";import{h as P}from"./QSelect.2fe94988.js";import{Q as A}from"./QForm.b991f9b4.js";import{Q as E,a as G}from"./QTable.9a8dde66.js";import{Q as L}from"./QPage.3d26b64d.js";import{Q as T}from"./QSpinnerBall.d12ddbce.js";import{a as v,s as Q}from"./axios.1d8a1e65.js";import"./selection.f59d8827.js";import"./QList.0fd3cdb9.js";const j=q({setup(){const e=u([]),o=u([]),m=u(!1),g=()=>{const l=$.getItem("empresa");let s;if(l)s=JSON.parse(l.toString()).id;else{alert("Debe seleccionar una empresa");return}d.show({message:"Cargando cuentas..."}),v.get("cuentasn1",{params:{id_empresa:s}}).then(h=>{e.value=h.data,d.hide()})},f=()=>{d.show({message:"Cargando cuentas nivel 2..."}),v.get("cuentasn2").then(l=>{o.value=l.data,d.hide()})},n=u({id:null,nombre:"",id_nivel1:null,correlativo:"",activo:!1}),t=u(""),C=[{name:"id",label:"ID",field:"id",align:"left"},{name:"nombre",label:"Nombre",field:"nombre",align:"left"},{name:"id_nivel1",label:"ID Nivel 1",field:"id_nivel1",align:"left"},{name:"nombre_nivel1",label:"Nombre Nivel 1",field:"nombre_nivel1",align:"left"},{name:"correlativo",label:"Correlativo",field:"correlativo",align:"left"},{name:"activo",label:"Activo",field:"activo",align:"left",format:l=>l?"S\xED":"No"},{name:"acciones",label:"Acciones",field:"",align:"center"}],N=async()=>{if(d.show({message:"Guardando cuenta...",spinner:T}),n.value.id===null||n.value.id===""){const l={_nombre:n.value.nombre,_id_nivel1:n.value.id_nivel1,_us_crea:"usrtest",_id:0,_activo:!0};await v.post("cuentasn2",l).then(s=>{Q("Cuenta nivel 2 guardada correctamente.")})}else{const l={_nombre:n.value.nombre,_id_nivel1:n.value.id_nivel1,_us_crea:"usrtest",_id:n.value.id,_activo:n.value.activo};await v.put("cuentasn2",l).then(s=>{Q("Cuenta nivel 2 guardada correctamente.")})}d.hide(),f(),_()},S=l=>{n.value={...l},m.value=!0},y=l=>{o.value=o.value.filter(s=>s.id!==l)},_=()=>{n.value={id:null,nombre:"",id_nivel1:null,correlativo:"",activo:!1},m.value=!1};return{cuentasNivel1:e,cuentas:o,form:n,filtro:t,columns:C,resetForm:_,getCuentasn1:g,getCuentasn2:f,guardarCuenta:N,editarCuenta:S,eliminarCuenta:y,filtrarCuentas:()=>{const l=t.value.toLowerCase();return o.value.filter(s=>s.id.toString().includes(l)||s.nombre.toLowerCase().includes(l)||s.id_nivel1.toString().includes(l)||s.correlativo.toString().includes(l)||(s.activo?"s\xED":"no").includes(l))},disableCuentasN1:m}},mounted(){this.getCuentasn1(),this.getCuentasn2()}}),J={class:"row q-col-gutter-sm"},M={class:"col-2"},O={class:"col-10"},z={class:"col-6"},H={class:"col-4"},K={class:"col-1"},R=r("div",{class:"col-12"},null,-1),W={class:"col-12 text-center q-gutter-sm"},X=r("div",{class:"text-h5"},"Cuentas nivel 2",-1);function Y(e,o,m,g,f,n){return F(),U(L,{padding:""},{default:i(()=>[a(k,null,{default:i(()=>[a(p,{label:"Sistema",icon:"home"}),a(p,{label:"Configuraci\xF3n",icon:"widgets"}),a(p,{label:"Gesti\xF3n de Cuentas Nivel 2",icon:"looks_two"})]),_:1}),a(V,{class:"q-mt-md"},{default:i(()=>[a(w,null,{default:i(()=>[a(A,{onSubmit:D(e.guardarCuenta,["prevent"])},{default:i(()=>[r("div",J,[r("div",M,[a(c,{modelValue:e.form.id,"onUpdate:modelValue":o[0]||(o[0]=t=>e.form.id=t),label:"Codigo",outlined:"",dense:"",disable:""},null,8,["modelValue"])]),r("div",O,[a(c,{modelValue:e.form.nombre,"onUpdate:modelValue":o[1]||(o[1]=t=>e.form.nombre=t),label:"Nombre",outlined:"",dense:""},null,8,["modelValue"])]),r("div",z,[a(P,{modelValue:e.form.id_nivel1,"onUpdate:modelValue":o[2]||(o[2]=t=>e.form.id_nivel1=t),options:e.cuentasNivel1,label:"Cuenta Nivel 1",outlined:"",dense:"","emit-value":"","map-options":"","option-value":"id","option-label":"nombre",disable:e.disableCuentasN1},null,8,["modelValue","options","disable"])]),r("div",H,[a(c,{modelValue:e.form.correlativo,"onUpdate:modelValue":o[3]||(o[3]=t=>e.form.correlativo=t),label:"Correlativo",outlined:"",dense:"",disable:""},null,8,["modelValue"])]),r("div",K,[a(I,{modelValue:e.form.activo,"onUpdate:modelValue":o[4]||(o[4]=t=>e.form.activo=t),label:"Activo","left-label":"",class:"q-pl-md toggle-center-div-dense"},null,8,["modelValue"])]),R,r("div",W,[a(b,{type:"submit",label:"Guardar",color:"primary",push:"",class:"btn-fixed-width",disable:!0}),a(b,{label:"Cancelar",color:"primary",flat:"",class:"btn-fixed-width",onClick:e.resetForm},null,8,["onClick"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1}),a(V,{class:"q-my-md"},{default:i(()=>[a(w,null,{default:i(()=>[X,a(c,{modelValue:e.filtro,"onUpdate:modelValue":o[5]||(o[5]=t=>e.filtro=t),label:"Buscar",outlined:"",dense:"",class:"q-my-md"},null,8,["modelValue"]),a(E,{style:{height:"400px"},flat:"","virtual-scroll":"",separator:"cell",bordered:"","rows-per-page-options":[0],class:"my-sticky-header-table",rows:e.filtrarCuentas(),columns:e.columns,"row-key":"id"},{"body-cell-acciones":i(t=>[a(G,{props:t},{default:i(()=>[a(b,{icon:"edit",color:"primary",dense:"",onClick:C=>e.editarCuenta(t.row),disable:!0},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})]),_:1})}var de=B(j,[["render",Y]]);export{de as default};
