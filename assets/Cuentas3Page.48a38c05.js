import{_ as U,d as B,g as u,o as D,ax as $,w as s,P as q,a as r,e as n,i as V,aA as A,f as t,j as v,b8 as I,l as p,Q as h}from"./index.de91045c.js";import{h as w}from"./QSelect.2ed87d02.js";import{Q as P}from"./QForm.a37c3e13.js";import{Q as E,a as F}from"./QTable.ff5ff233.js";import{Q as L}from"./QPage.c00b98e2.js";import{Q as T}from"./QSpinnerBall.16c3a4f2.js";import{a as m,s as N}from"./axios.23fd2c5d.js";import"./selection.4860df2b.js";import"./QList.35154e5b.js";const G=B({setup(){const l=u([]),o=u([]),d=u([]),b=()=>{const a=q.getItem("empresa");let i;if(a)i=JSON.parse(a.toString()).id;else{alert("Debe seleccionar una empresa");return}r.show({message:"Cargando cuentas nivel 1..."}),m.get("cuentasn1",{params:{id_empresa:i}}).then(C=>{l.value=C.data,r.hide()})},g=()=>{r.show({message:"Cargando cuentas nivel 2..."}),m.get("cuentasn2/"+e.value.id_nivel1).then(a=>{o.value=a.data,r.hide()})},c=()=>{r.show({message:"Cargando cuentas nivel 3..."}),m.get("cuentasn3").then(a=>{d.value=a.data,r.hide()})},e=u({id:null,nombre:"",id_nivel1:null,id_nivel2:null,correlativo:"",activo:!0}),f=u(""),Q=[{name:"id",label:"ID",field:"id",align:"left"},{name:"nombre",label:"Nombre",field:"nombre",align:"left"},{name:"id_nivel1",label:"ID Nivel 1",field:"id_nivel1",align:"left"},{name:"nombre_nivel1",label:"Nombre Nivel 1",field:"nombre_nivel1",align:"left"},{name:"id_nivel2",label:"ID Nivel 2",field:"id_nivel2",align:"left"},{name:"nombre_nivel2",label:"Nombre Nivel 2",field:"nombre_nivel2",align:"left"},{name:"correlativo",label:"Correlativo",field:"correlativo",align:"left"},{name:"activo",label:"Activo",field:"activo",align:"left",format:a=>a?"S\xED":"No"},{name:"acciones",label:"Acciones",field:"",align:"center"}],y=async()=>{if(r.show({message:"Guardando cuenta...",spinner:T}),e.value.id===null||e.value.id===""){const a={_nombre:e.value.nombre,_id_nivel1:e.value.id_nivel1,_id_nivel2:e.value.id_nivel2,_us_crea:"usrtest",_id:e.value.id,_activo:e.value.activo};await m.post("cuentasn3",a).then(i=>{N("Cuenta nivel 3 guardada correctamente.")})}else{const a={_nombre:e.value.nombre,_id_nivel1:e.value.id_nivel1,_id_nivel2:e.value.id_nivel2,_us_crea:"usrtest",_id:e.value.id,_activo:e.value.activo};await m.put("cuentasn3",a).then(i=>{N("Cuenta nivel 3 guardada correctamente.")})}r.hide(),c(),_()},S=a=>{e.value={...a}},k=a=>{d.value=d.value.filter(i=>i.id!==a)},_=()=>{e.value={id:null,nombre:"",id_nivel1:null,id_nivel2:null,correlativo:"",activo:!0}};return{cuentasNivel1:l,cuentasNivel2:o,cuentas:d,form:e,filtro:f,columns:Q,resetForm:_,getCuentasn1:b,getCuentasn2:g,getCuentasn3:c,guardarCuenta:y,editarCuenta:S,eliminarCuenta:k,filtrarCuentas:()=>{const a=f.value.toLowerCase();return d.value.filter(i=>i.id.toString().includes(a)||i.nombre.toLowerCase().includes(a)||i.id_nivel1.toString().includes(a)||i.correlativo.toString().includes(a)||(i.activo?"s\xED":"no").includes(a))}}},mounted(){this.getCuentasn1(),this.getCuentasn3()}}),j={class:"row q-col-gutter-sm"},J={class:"col-2"},M={class:"col-10"},O={class:"col-4"},z={class:"col-5"},H={class:"col-2"},K={class:"col-1"},R=t("div",{class:"col-12"},null,-1),W={class:"col-12 text-center q-gutter-sm"},X=t("div",{class:"text-h5"},"Cuentas nivel 3",-1);function Y(l,o,d,b,g,c){return D(),$(L,{padding:""},{default:s(()=>[n(h,{class:"q-mt-md"},{default:s(()=>[n(V,null,{default:s(()=>[n(P,{onSubmit:A(l.guardarCuenta,["prevent"])},{default:s(()=>[t("div",j,[t("div",J,[n(v,{modelValue:l.form.id,"onUpdate:modelValue":o[0]||(o[0]=e=>l.form.id=e),label:"Codigo",outlined:"",dense:"",disable:""},null,8,["modelValue"])]),t("div",M,[n(v,{modelValue:l.form.nombre,"onUpdate:modelValue":o[1]||(o[1]=e=>l.form.nombre=e),label:"Nombre",outlined:"",dense:""},null,8,["modelValue"])]),t("div",O,[n(w,{modelValue:l.form.id_nivel1,"onUpdate:modelValue":[o[2]||(o[2]=e=>l.form.id_nivel1=e),l.getCuentasn2],options:l.cuentasNivel1,label:"Cuenta Nivel 1",outlined:"",dense:"","emit-value":"","map-options":"","option-value":"id","option-label":"nombre"},null,8,["modelValue","options","onUpdate:modelValue"])]),t("div",z,[n(w,{modelValue:l.form.id_nivel2,"onUpdate:modelValue":o[3]||(o[3]=e=>l.form.id_nivel2=e),options:l.cuentasNivel2,label:"Cuenta Nivel 2",outlined:"",dense:"","emit-value":"","map-options":"","option-value":"id","option-label":"nombre",disable:!l.form.id_nivel1},null,8,["modelValue","options","disable"])]),t("div",H,[n(v,{modelValue:l.form.correlativo,"onUpdate:modelValue":o[4]||(o[4]=e=>l.form.correlativo=e),label:"Correlativo",outlined:"",dense:"",disable:""},null,8,["modelValue"])]),t("div",K,[n(I,{modelValue:l.form.activo,"onUpdate:modelValue":o[5]||(o[5]=e=>l.form.activo=e),label:"Activo","left-label":"",class:"toggle-center-div-dense"},null,8,["modelValue"])]),R,t("div",W,[n(p,{type:"submit",label:"Guardar",color:"primary",push:"",class:"btn-fixed-width",disable:!0}),n(p,{label:"Cancelar",color:"primary",flat:"",class:"btn-fixed-width",onClick:l.resetForm},null,8,["onClick"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1}),n(h,{class:"q-my-md"},{default:s(()=>[n(V,null,{default:s(()=>[X,n(v,{modelValue:l.filtro,"onUpdate:modelValue":o[6]||(o[6]=e=>l.filtro=e),label:"Buscar",outlined:"",dense:"",class:"q-my-md"},null,8,["modelValue"]),n(E,{style:{height:"400px"},flat:"","virtual-scroll":"",separator:"cell",bordered:"","rows-per-page-options":[0],class:"my-sticky-header-table",rows:l.filtrarCuentas(),columns:l.columns,"row-key":"id"},{"body-cell-acciones":s(e=>[n(F,{props:e},{default:s(()=>[n(p,{icon:"edit",color:"primary",dense:"",onClick:f=>l.editarCuenta(e.row),disable:!0},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})]),_:1})}var re=U(G,[["render",Y]]);export{re as default};
