import{Q as k,a as f}from"./QBreadcrumbs.9bfe4400.js";import{_ as B,U as S,r as d,V as N,W as q,Z as t,a1 as r,a2 as _,aj as U,a as u,a4 as h,b5 as $,$ as s,a5 as p,b6 as F,a6 as v}from"./index.8a1bf270.js";import{d as T}from"./QList.30e78d99.js";import{Q as A}from"./QForm.4e813ace.js";import{Q as E,a as L}from"./QTable.4cac302a.js";import{Q as G}from"./QSpinnerBall.cacf6e14.js";import{a as c,s as w}from"./axios.d4a7e69c.js";import"./selection.775008b3.js";import"./axios.bf56c3c5.js";const I=S({setup(){const e=d([]),n=d([]),m=d(""),l=d({id:null,nombre:"",nit:"",contador:"",activo:!0}),y=[{name:"nombre",label:"Nombre",field:"nombre_contribuyente",align:"left"},{name:"nit",label:"NIT",field:"nit",align:"left"},{name:"contador",label:"Contador",field:"contador",align:"left"},{name:"activo",label:"Activo",field:"activo",align:"left",format:o=>o?"S\xED":"No"},{name:"acciones",label:"Acciones",field:"",align:"center",style:"width:100px"}],b=()=>{u.show({message:"Cargando contribuyentes"}),c.get("/contribuyentes").then(o=>{e.value=o.data,u.hide()})},a=()=>{c.get("/contadores").then(o=>{n.value=o.data})},C=async()=>{if(u.show({message:"Guardando...",spinner:G}),l.value.id===null){const o={_nombre_contribuyente:l.value.nombre,_nit:l.value.nit,_idcontador:l.value.contador,_us_crea:"usrtest",_id:0,_activo:!0};await c.post("/contribuyentes",o).then(i=>{w("Contribuyente guardado correctamente.",{})})}else{const o={_id:l.value.id,_nombre_contribuyente:l.value.nombre,_nit:l.value.nit,_idcontador:l.value.contador,_activo:l.value.activo,_us_crea:"usrtest"};await c.put("/contribuyentes",o).then(i=>{w("Contribuyente actualizado correctamente.",{})})}u.hide(),b(),g()},V=o=>{l.value={id:o.id,nombre:o.nombre_contribuyente,nit:o.nit,contador:o.idcontador,activo:o.activo}},Q=o=>{e.value=e.value.filter(i=>i.id!==o)},g=()=>{l.value={id:null,nombre:"",nit:"",contador:"",activo:!0}};return{contribuyentes:e,contadores:n,form:l,filtro:m,columns:y,resetForm:g,getContribuyentes:b,getContadores:a,guardarContribuyente:C,editarContribuyente:V,eliminarContribuyente:Q,filtrarContribuyentes:()=>{const o=m.value.toLowerCase();return e.value.filter(i=>i.nombre_contribuyente.toLowerCase().includes(o)||i.nit.toLowerCase().includes(o)||(i.activo?"s\xED":"no").includes(o))}}},mounted(){this.getContadores(),this.getContribuyentes()}}),D={class:"q-pa-md"},P={class:"row q-gutter-sm"},j={class:"col-6"},z={class:"col-5"},M={class:"col-9"},W={class:"col-2"},Z=s("div",{class:"col-12"},null,-1),H={class:"col-12 text-center q-pa-md q-gutter-md"},J=s("div",{class:"text-h5"},"Contribuyentes",-1);function K(e,n,m,l,y,b){return N(),q("div",D,[t(k,null,{default:r(()=>[t(f,{label:"Sistema",icon:"home"}),t(f,{label:"Configuraci\xF3n",icon:"settings"}),t(f,{label:"Gesti\xF3n de Contribuyentes",icon:"diversity_3"})]),_:1}),t(_,{class:"q-mt-md"},{default:r(()=>[t(h,null,{default:r(()=>[t(A,{onSubmit:$(e.guardarContribuyente,["prevent"])},{default:r(()=>[s("div",P,[s("div",j,[t(p,{modelValue:e.form.nombre,"onUpdate:modelValue":n[0]||(n[0]=a=>e.form.nombre=a),label:"Nombre del contribuyente",outlined:"",dense:""},null,8,["modelValue"])]),s("div",z,[t(p,{modelValue:e.form.nit,"onUpdate:modelValue":n[1]||(n[1]=a=>e.form.nit=a),label:"NIT",outlined:"",dense:""},null,8,["modelValue"])]),s("div",M,[t(T,{modelValue:e.form.contador,"onUpdate:modelValue":n[2]||(n[2]=a=>e.form.contador=a),options:e.contadores,label:"Contador",outlined:"",dense:"","emit-value":"","map-options":"","option-value":"idcontador","option-label":"nombre"},null,8,["modelValue","options"])]),s("div",W,[t(F,{modelValue:e.form.activo,"onUpdate:modelValue":n[3]||(n[3]=a=>e.form.activo=a),label:"Activo","left-label":"",class:"toggle-center-div-dense"},null,8,["modelValue"])]),Z,s("div",H,[t(v,{type:"submit",label:"Guardar",color:"primary",push:"",class:"btn-fixed-width"}),t(v,{label:"Cancelar",color:"primary",flat:"",class:"btn-fixed-width",onClick:e.resetForm},null,8,["onClick"])])])]),_:1},8,["onSubmit"])]),_:1})]),_:1}),t(U,{spaced:"",dark:""}),t(_,{class:"my-card"},{default:r(()=>[t(h,null,{default:r(()=>[J,t(p,{modelValue:e.filtro,"onUpdate:modelValue":n[4]||(n[4]=a=>e.filtro=a),label:"Buscar Contribuyente",outlined:"",dense:"",class:"q-my-md"},null,8,["modelValue"]),t(E,{style:{height:"400px"},flat:"","virtual-scroll":"",separator:"cell",bordered:"","rows-per-page-options":[0],class:"my-sticky-header-table",rows:e.filtrarContribuyentes(),columns:e.columns,"row-key":"id"},{"body-cell-acciones":r(a=>[t(L,{props:a},{default:r(()=>[t(v,{icon:"edit",color:"primary",dense:"",onClick:C=>e.editarContribuyente(a.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1})]),_:1})])}var le=B(I,[["render",K]]);export{le as default};
