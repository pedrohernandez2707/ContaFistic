import{a as Q,Q as $}from"./QBreadcrumbs.e7843302.js";import{_ as A,U as O,r as u,V as f,aB as q,a1 as s,Z as a,a4 as T,$ as t,a5 as b,bh as H,b6 as L,w as C,ak as E,Q as F,a6 as S,a2 as B,W as y,aE as k,aF as M,aD as R}from"./index.636087c0.js";import{d as D}from"./QList.e1b348f8.js";import{r as Z,u as G,Q as P,a as Y,C as j,b as W}from"./xlsx.6af41f6a.js";import{Q as _}from"./QSlideTransition.455ad2fd.js";import{Q as K,a as x}from"./QTable.ba9f47a7.js";import{Q as X}from"./QPage.1f755c2f.js";import{a as z}from"./axios.bf56c3c5.js";import"./selection.5fba8b9b.js";import"./use-render-cache.3aae9b27.js";const m=new Date;m.getDate();m.getMonth()+1;m.getFullYear();m.setHours(0,-m.getTimezoneOffset(),0,0);let U=m.toJSON().slice(0,10).replaceAll("-","/");console.log(U);const ee=O({setup(){const e=u(null),o=u([]),N=u(!1),h=u(U),v=u(U),V=u([{}]),l=[{name:"Doc",label:"Doc. No",field:"documento",align:"left"},{name:"Serie",label:"Serie",field:"serie",align:"left"},{name:"Fecha",label:"Fecha",field:"fecha",align:"left"},{name:"Tipo",label:"Tipo",field:"tipo",align:"left",style:"max-width:120px;width:100px;"},{name:"NIT",label:"NIT",field:"nit",align:"left"},{name:"Comprador",label:"Comprador",field:"comprador",align:"left"},{name:"Cta",label:"Cta",field:"Cta",align:"left",style:"max-width:150px;width:150px"},{name:"Exportaciones",label:"Exportaciones",field:"exportaciones",align:"left"},{name:"Bienes",label:"Bienes",field:"bienes",align:"left"},{name:"Servicios",label:"Servicios",field:"servicios",align:"left"},{name:"Exentos",label:"Exentos",field:"Exentos",align:"left"},{name:"Total",label:"Total",field:"total",align:"left"},{name:"Iva",label:"Iva",field:"iva",align:"left"}],c=async()=>{if(e.value){const r=await e.value.arrayBuffer(),n=Z(r),w=n.Sheets[n.SheetNames[0]],i=G.sheet_to_json(w).map(d=>({documento:d["N\xFAmero del DTE"],serie:d.Serie,fecha:d["Fecha de emisi\xF3n"],tipo:d["Tipo de DTE (nombre)"],nit:d["ID del receptor"],comprador:d["Nombre completo del receptor"],total:d["Monto (Gran Total)"],iva:d["IVA (monto de este impuesto)"]}));V.value=i}return 0},I=u("eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJBZ2VuY2lhVmlydHVhbERURSIsImlzcyI6IlNBVCIsIm5pdCI6IjEwNDkwOTUwMSIsImV4cCI6MTcyNDc3MjU3NiwiaWF0IjoxNzI0NzI5Mzc2fQ.1h1lDjyLsrL7ZH9inMvVZ9PHV-xtBsN6qVdPK0uHB54"),J=()=>{const r=z.create();I.value===""&&r.get("http://localhost:5000/get-token").then(n=>{console.log(n.data),I.value=n.data}).catch(n=>console.error("Error:",n))},g=r=>{const[n,w,p]=r.split("/").map(Number),i=p.toString().padStart(2,"0"),d=w.toString().padStart(2,"0");return`${i}-${d}-${n}`};return{file:e,parsedCSV:o,visibleDate:N,fechai:h,fechaf:v,convert:c,columns:l,ventas:V,getdata:J,getFacturas:()=>{const r=z.create();console.log(g(h.value),g(v.value)),r.get("http://localhost:5000/get-fact",{headers:{Authorization:I.value},params:{nit:"104909501",fechai:g(h.value),fechaf:g(v.value),tipo:"R"}}).then(n=>{const p=n.data.data.map(i=>({documento:i.numeroDocumento,serie:i.serie,fecha:i.fechaEmision,tipo:i.tipo,proveedor:i.nombreEmisor,nit:i.nitEmisor,total:i.granTotal,iva:i.totalIva}));console.log(p),V.value=p}).catch(n=>console.error("Error:",n))}}},mounted(){this.getdata()}}),le={class:"row q-col-gutter-sm"},ae={class:"col-4"},oe={class:"col-4"},te={class:"col-4"},se={class:"col-4"},ne={class:"col-2"},ie={class:"col-3 text-right"},de={class:"col-3"},re={class:"col-12"},ue={class:"col-12"},me={class:"row q-col-gutter-sm"},ce={class:"col-5"},pe={class:"row items-center justify-end"},fe={class:"col-5"},be={class:"row items-center justify-end"},he={class:"col-2"},ve={class:"col-12"},Ve=t("div",{class:"text-h5"},"Detalle de ventas",-1),ge={class:"table table-bordered",id:"preview-table"};function we(e,o,N,h,v,V){return f(),q(X,{padding:""},{default:s(()=>[a($,null,{default:s(()=>[a(Q,{label:"Registros Contables",icon:"home"}),a(Q,{label:"Ingreso",icon:"widgets"}),a(Q,{label:"Libro Ventas",icon:"navigation"})]),_:1}),a(B,{class:"q-mt-md"},{default:s(()=>[a(T,null,{default:s(()=>[t("div",le,[t("div",ae,[a(b,{modelValue:e.text,"onUpdate:modelValue":o[0]||(o[0]=l=>e.text=l),type:"text",label:"No. Interno",outlined:"",dense:""},null,8,["modelValue"])]),t("div",oe,[a(D,{modelValue:e.model,"onUpdate:modelValue":o[1]||(o[1]=l=>e.model=l),options:e.options,label:"Mes",outlined:"",dense:""},null,8,["modelValue","options"])]),t("div",te,[a(D,{modelValue:e.model,"onUpdate:modelValue":o[2]||(o[2]=l=>e.model=l),options:e.options,label:"Periodo",outlined:"",dense:""},null,8,["modelValue","options"])]),t("div",se,[a(D,{modelValue:e.model,"onUpdate:modelValue":o[3]||(o[3]=l=>e.model=l),options:e.options,label:"Cuenta Debe",outlined:"",dense:""},null,8,["modelValue","options"])]),t("div",ne,[a(b,{modelValue:e.text,"onUpdate:modelValue":o[4]||(o[4]=l=>e.text=l),type:"text",label:"Cant. Facturas",outlined:"",dense:""},null,8,["modelValue"])]),t("div",ie,[a(H,{"left-label":"",modelValue:e.orange,"onUpdate:modelValue":o[5]||(o[5]=l=>e.orange=l),label:"Partida generada"},null,8,["modelValue"])]),t("div",de,[a(b,{modelValue:e.text,"onUpdate:modelValue":o[6]||(o[6]=l=>e.text=l),type:"text",label:"No.Partida",outlined:"",dense:""},null,8,["modelValue"])]),t("div",re,[a(L,{modelValue:e.visibleDate,"onUpdate:modelValue":o[7]||(o[7]=l=>e.visibleDate=l),label:"Consultar SAT"},null,8,["modelValue"])]),t("div",ue,[a(_,null,{default:s(()=>[C(t("div",me,[t("div",ce,[a(b,{dense:"",outlined:"",modelValue:e.fechai,"onUpdate:modelValue":o[9]||(o[9]=l=>e.fechai=l),mask:"date",rules:["date"],label:"Fecha Inicial","hide-bottom-space":"",placeholder:"YYYY/MM/DD",clearable:""},{append:s(()=>[a(F,{name:"event",class:"cursor-pointer"},{default:s(()=>[a(P,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[a(Y,{modelValue:e.fechai,"onUpdate:modelValue":o[8]||(o[8]=l=>e.fechai=l)},{default:s(()=>[t("div",pe,[C(a(S,{label:"Cerrar",color:"primary",flat:""},null,512),[[j]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t("div",fe,[a(b,{dense:"",outlined:"",modelValue:e.fechaf,"onUpdate:modelValue":o[11]||(o[11]=l=>e.fechaf=l),mask:"date",rules:["date"],"hide-bottom-space":"",label:"Fecha Final",placeholder:"YYYY/MM/DD",clearable:""},{append:s(()=>[a(F,{name:"event",class:"cursor-pointer"},{default:s(()=>[a(P,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:s(()=>[a(Y,{modelValue:e.fechaf,"onUpdate:modelValue":o[10]||(o[10]=l=>e.fechaf=l)},{default:s(()=>[t("div",be,[C(a(S,{label:"Cerrar",color:"primary",flat:""},null,512),[[j]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),t("div",he,[a(S,{color:"primary",label:"Consultar",onClick:e.getFacturas},null,8,["onClick"])])],512),[[E,e.visibleDate]])]),_:1})]),t("div",ve,[a(_,null,{default:s(()=>[C(a(W,{modelValue:e.file,"onUpdate:modelValue":[o[12]||(o[12]=l=>e.file=l),e.convert],label:"Seleccione o arraste un archivo para importar(.xls)",outlined:"",accept:".xls",clearable:""},null,8,["modelValue","onUpdate:modelValue"]),[[E,!e.visibleDate]])]),_:1})])])]),_:1})]),_:1}),a(B,{class:"q-mt-sm"},{default:s(()=>[a(T,null,{default:s(()=>[Ve,a(K,{style:{height:"400px"},flat:"",bordered:"","virtual-scroll":"",separator:"cell","rows-per-page-options":[0],class:"my-sticky-header-table",rows:e.ventas,columns:e.columns,"row-key":"id",dense:""},{"body-cell-Cta":s(l=>[a(x,{props:l},{default:s(()=>[a(D,{modelValue:l.row.Cta,"onUpdate:modelValue":c=>l.row.Cta=c,options:[{label:"Gastos",value:"1.2"},{label:"Bienes",value:"2.15"}],borderless:"",dense:"","options-dense":"","use-input":"","input-debounce":"0",class:"full-width"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"]),t("table",ge,[t("tbody",null,[(f(!0),y(M,null,k(e.parsedCSV,l=>(f(),y("tr",null,[(f(!0),y(M,null,k(l,c=>(f(),y("td",null,R(c),1))),256))]))),256))])])]),_:1})]),_:1})]),_:1})}var Be=A(ee,[["render",we]]);export{Be as default};
